use num_bigint::BigUint;
use once_cell::sync::Lazy;
use sha2::{Digest, Sha512};

static BASE_FILED_P: Lazy<BigUint> =
    Lazy::new(|| BigUint::from(2u8).pow(255) - BigUint::from(19u8));

pub(crate) struct Ed25519 {}

impl Ed25519 {
    fn sha512(s: &str) -> [u8; 64] {
        let mut sha512 = Sha512::default();

        sha512.update(s.as_bytes());
        sha512.finalize_reset().into()
    }
}

mod tests {
    use super::*;
    #[test]
    fn test_sha512() {
        let input = "abc";

        let actual = Ed25519::sha512(input);

        // 期待される SHA-512("abc") の値
        let expected: [u8; 64] = [
            0xdd, 0xaf, 0x35, 0xa1, 0x93, 0x61, 0x7a, 0xba, 0xcc, 0x41, 0x73, 0x49, 0xae, 0x20,
            0x41, 0x31, 0x12, 0xe6, 0xfa, 0x4e, 0x89, 0xa9, 0x7e, 0xa2, 0x0a, 0x9e, 0xee, 0xe6,
            0x4b, 0x55, 0xd3, 0x9a, 0x21, 0x92, 0x99, 0x2a, 0x27, 0x4f, 0xc1, 0xa8, 0x36, 0xba,
            0x3c, 0x23, 0xa3, 0xfe, 0xeb, 0xbd, 0x45, 0x4d, 0x44, 0x23, 0x64, 0x3c, 0xe8, 0x0e,
            0x2a, 0x9a, 0xc9, 0x4f, 0xa5, 0x4c, 0xa4, 0x9f,
        ];

        assert_eq!(actual, expected);
    }
}
